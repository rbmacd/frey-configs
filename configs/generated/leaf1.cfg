! Device: leaf1
! Generated: 2025-11-21T23:14:47Z
! Role: leaf
!
!
! Hostname
hostname leaf1
!
! DNS Configuration
ip name-server vrf default 10.0.0.50
ip name-server vrf default 10.0.0.51
!
! NTP Configuration
ntp server 10.0.0.100
ntp server 10.0.0.101
!
! Timezone
clock timezone UTC
!
! Banner - Customized by device role
banner motd
*****************************************
* LEAF SWITCH - Unauthorized access prohibited
* All activity is logged and monitored
*****************************************
EOF
!
! SNMP Configuration
!
! Logging
logging host 10.0.0.200
logging buffered 10000
!
! Users
username admin privilege 15 role network-admin secret sha512 $6$wI/1gZmxd5NNx0tI$vFwxFGzNYqKapXy5Pjf4wYmFX2mXb58fFa3hRF3KWyAUQXtpeZHfFs8kMrCCzWIB6VjXSqMKX8tUKNWbJyDqQ.
!
! AAA
aaa authorization exec default local
!
interface Management0
   description Management Interface
   ip address 172.20.20.4/24
!
ip route 0.0.0.0/0 172.20.20.1
!
! AAA
aaa authorization exec default local
!
! Enable IP routing
ip routing
!
!
! VLAN Configuration
vlan 10
   name VLAN10
!
vlan 20
   name VLAN20
!
vlan 30
   name VLAN30
!

!
!
! Physical Interfaces
interface eth1
      description to_spine1
         no shutdown
         no switchport
      ip address 10.0.0.1/31
      !
interface eth2
      description to_spine2
         no shutdown
         no switchport
      ip address 10.0.6.1/31
      !
interface eth48
      description to_server1-blue
         no shutdown
         switchport mode access
   switchport access vlan 10
   !

!
!
! Loopback for VTEP
interface Loopback1
   description VTEP Loopback
   ip address 10.255.254.101/32
!
! VXLAN Configuration

! VXLAN interface
interface Vxlan1
   description VXLAN Tunnel Interface
      vxlan source-interface Loopback1
         vxlan udp-port 4789
            vxlan vlan 10 vni 10010
      vxlan vlan 20 vni 10020
      vxlan vlan 30 vni 10030
         !

!
!
! BGP Loopback0 (Router ID)
interface Loopback0
   description BGP Router ID
   ip address 10.255.255.101/32
!
!
! BGP Configuration

! Prefix lists (must be defined before route-maps)

! Route-map for BGP (defined after prefix-lists)

! BGP Configuration
router bgp 65100
   !
   no bgp default ipv4-unicast
   !
         router-id 10.255.255.101
                                       !
   address-family ipv4
           network 10.255.255.101/32
              network 10.255.254.101/32
                                 !
      maximum-paths 4
         maximum-paths 4 ecmp 4
         !
   ! Peer Groups
         neighbor LEAF_UNDERLAY peer group
               neighbor LEAF_UNDERLAY send-community extended
               address-family ipv4
     neighbor LEAF_UNDERLAY activate
      !
      neighbor EVPN_OVERLAY peer group
         neighbor EVPN_OVERLAY update-source Loopback1
         neighbor EVPN_OVERLAY ebgp-multihop 2
         neighbor EVPN_OVERLAY send-community extended
            neighbor EVPN_OVERLAY next-hop-unchanged
   address-family evpn
     neighbor EVPN_OVERLAY activate
     neighbor EVPN_OVERLAY encapsulation vxlan
         !
         !
   ! Underlay BGP Neighbors
   ! Note: For underlay neighbors to work, add "ip" field to each neighbor in config_context
   ! Example: {"ip": "10.0.0.0", "peer_group": "LEAF_UNDERLAY", "remote_as": 65000}
      router bgp 65100
         neighbor 10.0.0.0 peer group LEAF_UNDERLAY
   neighbor 10.0.0.0 remote-as 65000
      neighbor 10.0.0.0 description spine1
               neighbor 10.0.6.0 peer group LEAF_UNDERLAY
   neighbor 10.0.6.0 remote-as 65000
      neighbor 10.0.6.0 description spine2
               !
   ! EVPN Configuration
      !
      router bgp 65100
         neighbor 10.255.255.2 peer group EVPN_OVERLAY
   neighbor 10.255.255.2 remote-as 65000
            neighbor 10.255.255.1 peer group EVPN_OVERLAY
   neighbor 10.255.255.1 remote-as 65000
            !
      !
   ! MAC-VRF EVPN Configuration for Leaf Switches
               vlan 10
     rd 65100:10010
     route-target both 10:10010
     redistribute learned
   !
      vlan 20
     rd 65100:10020
     route-target both 20:10020
     redistribute learned
   !
      vlan 30
     rd 65100:10030
     route-target both 30:10030
     redistribute learned
   !
            !
      !
      !
      !
!

!
end